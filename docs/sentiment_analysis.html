
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Sentiment Classifier And Analysis &#8212; Topic Modelling And Sentiment Analysis For Oberoi Delhi</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Topic Modelling" href="topic_modelling.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Topic Modelling And Sentiment Analysis For Oberoi Delhi</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Topic Modelling & Sentiment Analysis Of Tripadvisor Reviews for Oberoi Delhi
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="about.html">
   About
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scraping_script.html">
   Scraping Review Data From TripAdvisor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_cleaning_script.html">
   Data Pre Processing And Cleaning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reviews_cleaning_script.html">
   Reviews Data Cleaning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lemmetization_script.html">
   Lemmatizing Review Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eda_script.html">
   Exploratory Data Analysis (EDA)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="topic_modelling.html">
   Topic Modelling
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Sentiment Classifier And Analysis
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/AalokAtre/Oberoi_Delhi/master?urlpath=tree/docs/docs/sentiment_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/AalokAtre/Oberoi_Delhi"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/AalokAtre/Oberoi_Delhi/issues/new?title=Issue%20on%20page%20%2Fdocs/sentiment_analysis.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/docs/sentiment_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Sentiment Classifier And Analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="sentiment-classifier-and-analysis">
<h1>Sentiment Classifier And Analysis<a class="headerlink" href="#sentiment-classifier-and-analysis" title="Permalink to this headline">#</a></h1>
<p>We will leverage the spacy library to train a sentiment classifier. We will then use this trained model to predict a few custom reviews and check if the model is able to predict the sentiment of these reviews</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Importing libraries
import pandas as pd
from datetime import datetime
import spacy
import spacy_transformers

# Storing docs in binary format
from spacy.tokens import DocBin
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df = pd.read_csv(&#39;../data/final_dataset.csv&#39;)
df.shape
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2896, 6)
</pre></div>
</div>
</div>
</div>
<p>Splitting our dataset into train and test sets in 80-20 split.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>train = df.sample(frac = 0.8, random_state = 25)
test = df.drop(train.index)
print(train.shape, test.shape)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2317, 6) (579, 6)
</pre></div>
</div>
</div>
</div>
<p>Importing the required spacy package. English pipeline optimized for CPU. Components: tok2vec, tagger, parser, senter, ner, attribute_ruler, lemmatizer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import spacy
nlp=spacy.load(&quot;en_core_web_sm&quot;)
nlp.pipe_names
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;tok2vec&#39;, &#39;tagger&#39;, &#39;parser&#39;, &#39;attribute_ruler&#39;, &#39;lemmatizer&#39;, &#39;ner&#39;]
</pre></div>
</div>
</div>
</div>
<p>First step is to create tuples which are pairs of text along with sentiments. Creating tuples for both train dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>train[&#39;tuples&#39;] = train.apply(lambda row: (row[&#39;Customer Review&#39;],row[&#39;Customer Rating&#39;]), axis=1)
train = train[&#39;tuples&#39;].tolist()
</pre></div>
</div>
</div>
</div>
<p>Creating tuples for test dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>test[&#39;tuples&#39;] = test.apply(lambda row: (row[&#39;Customer Review&#39;],row[&#39;Customer Rating&#39;]), axis=1)
test = test[&#39;tuples&#39;].tolist()
</pre></div>
</div>
</div>
</div>
<p>Checking one of the tuples that were created above. As you can see it is a combination of review and its sentiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>train[0]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;great property warm welcome staff food delicious great stay definitely recommend family friend staff go extra mile stay comfortable&#39;,
 &#39;Excellent&#39;)
</pre></div>
</div>
</div>
</div>
<p>The second step is to create a spaCy document for each tuple in the train and test dataset with the help of a transformer model (en_core_web_sm)using a spacy pipeline called nlp. Each tuple is nothing but text and its sentiments. Note here that we map 4 and 5 star ratings (Excellent and Very Good as positive sentiments), 1 and 2 start rating (Poor and Terrible) as negative and everything else i.e 3 star as Neutral</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def document(data):
  text = []
  for doc, label in nlp.pipe(data, as_tuples = True):
    if (label==&#39;Excellent&#39;):
      doc.cats[&#39;positive&#39;] = 1
      doc.cats[&#39;negative&#39;] = 0
      doc.cats[&#39;neutral&#39;]  = 0
    elif (label==&#39;Very Good&#39;):
      doc.cats[&#39;positive&#39;] = 1
      doc.cats[&#39;negative&#39;] = 0
      doc.cats[&#39;neutral&#39;]  = 0
    elif (label==&#39;Poor&#39;):
      doc.cats[&#39;positive&#39;] = 0
      doc.cats[&#39;negative&#39;] = 1
      doc.cats[&#39;neutral&#39;]  = 0
    elif (label==&#39;Terrible&#39;):
      doc.cats[&#39;positive&#39;] = 0
      doc.cats[&#39;negative&#39;] = 1
      doc.cats[&#39;neutral&#39;]  = 0
    else:
      doc.cats[&#39;positive&#39;] = 0
      doc.cats[&#39;negative&#39;] = 0
      doc.cats[&#39;neutral&#39;]  = 1
    text.append(doc)
  
  return(text)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Calculate the time for converting into binary document for train dataset

start_time = datetime.now()

#passing the train dataset into function &#39;document&#39;
train_docs = document(train)

#Creating binary document using DocBin function in spaCy
doc_bin = DocBin(docs = train_docs)

#Saving the binary document as train.spacy
doc_bin.to_disk(&quot;train.spacy&quot;)
end_time = datetime.now()

#Printing the time duration for train dataset
print(&#39;Duration: {}&#39;.format(end_time - start_time))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration: 0:00:02.901909
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Calculate the time for converting into binary document for test dataset

start_time = datetime.now()

#passing the test dataset into function &#39;document&#39;
test_docs = document(test)
doc_bin = DocBin(docs = test_docs)
doc_bin.to_disk(&quot;test.spacy&quot;)
end_time = datetime.now()

#Printing the time duration for test dataset
print(&#39;Duration: {}&#39;.format(end_time - start_time))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration: 0:00:00.758820
</pre></div>
</div>
</div>
</div>
<p>We use the base spacy config file to define our own configuration for model parameters. Default configurtions are more than enough for us. All we need to do is define the paths for train and dev files</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#Converting base configuration into full config file
!python -m spacy init fill-config ./base_config.cfg ./config.cfg
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-C2">✔ Auto-filled config with all values</span>
<span class=" -Color -Color-C2">✔ Saved config</span>
config.cfg
You can now add your data and train your pipeline:
python -m spacy train config.cfg --paths.train ./train.spacy --paths.dev ./dev.spacy
</pre></div>
</div>
</div>
</div>
<p>Finally we run the script to train our spacy model to perform sentiment analysis. This model will then be saved to output updated folder from where we can leverage the trained model to predict review sentiments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>start_time = datetime.now()

!python -m spacy train ./config.cfg --verbose  --output ./output_updated

end_time = datetime.now()

print(&#39;Duration: {}&#39;.format(end_time - start_time))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-C4">ℹ Saving to output directory: output_updated</span>
<span class=" -Color -Color-C4">ℹ Using CPU</span>
<span class=" -Color -Color-C4">ℹ To switch to GPU 0, use the option: --gpu-id 0</span>

<span class=" -Color -Color-Bold">=========================== Initializing pipeline ===========================</span>
[2022-12-15 23:12:14,530] [INFO] Set up nlp object from config
[2022-12-15 23:12:14,535] [DEBUG] Loading corpus from path: test.spacy
[2022-12-15 23:12:14,535] [DEBUG] Loading corpus from path: train.spacy
[2022-12-15 23:12:14,535] [INFO] Pipeline: [&#39;textcat&#39;]
[2022-12-15 23:12:14,537] [INFO] Created vocabulary
[2022-12-15 23:12:14,537] [INFO] Finished initializing nlp object
[2022-12-15 23:12:15,183] [INFO] Initialized pipeline components: [&#39;textcat&#39;]
<span class=" -Color -Color-C2">✔ Initialized pipeline</span>

<span class=" -Color -Color-Bold">============================= Training pipeline =============================</span>
[2022-12-15 23:12:15,189] [DEBUG] Loading corpus from path: test.spacy
[2022-12-15 23:12:15,189] [DEBUG] Loading corpus from path: train.spacy
<span class=" -Color -Color-C4">ℹ Pipeline: [&#39;textcat&#39;]</span>
<span class=" -Color -Color-C4">ℹ Initial learn rate: 0.001</span>
E    #       LOSS TEXTCAT  CATS_SCORE  SCORE 
---  ------  ------------  ----------  ------
  0       0          0.22        0.00    0.00
  0     200          9.22       32.51    0.33
  0     400          4.65       32.51    0.33
  0     600          5.71       32.51    0.33
  1     800          3.84       32.51    0.33
  1    1000          3.82       32.54    0.33
  2    1200          3.17       32.51    0.33
  3    1400          2.37       43.65    0.44
  4    1600          1.10       43.65    0.44
  5    1800          0.49       43.65    0.44
  6    2000          0.33       43.65    0.44
  8    2200          0.19       46.42    0.46
 10    2400          0.15       46.42    0.46
 12    2600          0.16       46.42    0.46
 15    2800          0.16       46.42    0.46
 17    3000          0.15       46.42    0.46
 19    3200          0.12       46.42    0.46
 21    3400          0.12       46.42    0.46
 24    3600          0.12       46.42    0.46
 26    3800          0.16       46.42    0.46
<span class=" -Color -Color-C2">✔ Saved pipeline to output directory</span>
output_updated/model-last
Duration: 0:00:14.904080
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>text = &quot;The stay was bad. The serivce was poor.&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#Test the data from the best model
nlp = spacy.load(&quot;output_updated/model-best&quot;)
demo = nlp(text)
print(demo.cats)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;positive&#39;: 0.25720450282096863, &#39;negative&#39;: 0.4230425953865051, &#39;neutral&#39;: 0.31975290179252625}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>text1 = &quot;We had an amazing time. The rooms were very clean. The food tasted amazing and staff was very courteous&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#Test the data from the best model
nlp = spacy.load(&quot;output_updated/model-best&quot;)
demo = nlp(text1)
print(demo.cats)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;positive&#39;: 0.9619991779327393, &#39;negative&#39;: 0.013230466283857822, &#39;neutral&#39;: 0.024770323187112808}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>text2 = &quot;Stay was as expected. The service was on par with our expecations&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#Test the data from the best model
nlp = spacy.load(&quot;output_updated/model-best&quot;)
demo = nlp(text2)
print(demo.cats)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;positive&#39;: 0.7474048137664795, &#39;negative&#39;: 0.1129467636346817, &#39;neutral&#39;: 0.13964837789535522}
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="topic_modelling.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Topic Modelling</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Aalok Atre<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>